(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();var T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Y(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var I={exports:{}},w=typeof Reflect=="object"?Reflect:null,A=w&&typeof w.apply=="function"?w.apply:function(t,e,s){return Function.prototype.apply.call(t,e,s)},P;w&&typeof w.ownKeys=="function"?P=w.ownKeys:Object.getOwnPropertySymbols?P=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:P=function(t){return Object.getOwnPropertyNames(t)};function Q(n){console&&console.warn&&console.warn(n)}var W=Number.isNaN||function(t){return t!==t};function g(){g.init.call(this)}I.exports=g;I.exports.once=et;g.EventEmitter=g;g.prototype._events=void 0;g.prototype._eventsCount=0;g.prototype._maxListeners=void 0;var N=10;function S(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return N},set:function(n){if(typeof n!="number"||n<0||W(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");N=n}});g.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};g.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||W(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function q(n){return n._maxListeners===void 0?g.defaultMaxListeners:n._maxListeners}g.prototype.getMaxListeners=function(){return q(this)};g.prototype.emit=function(t){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var r=t==="error",i=this._events;if(i!==void 0)r=r&&i.error===void 0;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var h=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw h.context=o,h}var l=i[t];if(l===void 0)return!1;if(typeof l=="function")A(l,this,e);else for(var d=l.length,a=F(l,d),s=0;s<d;++s)A(a[s],this,e);return!0};function $(n,t,e,s){var r,i,o;if(S(e),i=n._events,i===void 0?(i=n._events=Object.create(null),n._eventsCount=0):(i.newListener!==void 0&&(n.emit("newListener",t,e.listener?e.listener:e),i=n._events),o=i[t]),o===void 0)o=i[t]=e,++n._eventsCount;else if(typeof o=="function"?o=i[t]=s?[e,o]:[o,e]:s?o.unshift(e):o.push(e),r=q(n),r>0&&o.length>r&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=n,h.type=t,h.count=o.length,Q(h)}return n}g.prototype.addListener=function(t,e){return $(this,t,e,!1)};g.prototype.on=g.prototype.addListener;g.prototype.prependListener=function(t,e){return $(this,t,e,!0)};function Z(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function B(n,t,e){var s={fired:!1,wrapFn:void 0,target:n,type:t,listener:e},r=Z.bind(s);return r.listener=e,s.wrapFn=r,r}g.prototype.once=function(t,e){return S(e),this.on(t,B(this,t,e)),this};g.prototype.prependOnceListener=function(t,e){return S(e),this.prependListener(t,B(this,t,e)),this};g.prototype.removeListener=function(t,e){var s,r,i,o,h;if(S(e),r=this._events,r===void 0)return this;if(s=r[t],s===void 0)return this;if(s===e||s.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,s.listener||e));else if(typeof s!="function"){for(i=-1,o=s.length-1;o>=0;o--)if(s[o]===e||s[o].listener===e){h=s[o].listener,i=o;break}if(i<0)return this;i===0?s.shift():J(s,i),s.length===1&&(r[t]=s[0]),r.removeListener!==void 0&&this.emit("removeListener",t,h||e)}return this};g.prototype.off=g.prototype.removeListener;g.prototype.removeAllListeners=function(t){var e,s,r;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var i=Object.keys(s),o;for(r=0;r<i.length;++r)o=i[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=s[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this};function U(n,t,e){var s=n._events;if(s===void 0)return[];var r=s[t];return r===void 0?[]:typeof r=="function"?e?[r.listener||r]:[r]:e?tt(r):F(r,r.length)}g.prototype.listeners=function(t){return U(this,t,!0)};g.prototype.rawListeners=function(t){return U(this,t,!1)};g.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):z.call(n,t)};g.prototype.listenerCount=z;function z(n){var t=this._events;if(t!==void 0){var e=t[n];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}g.prototype.eventNames=function(){return this._eventsCount>0?P(this._events):[]};function F(n,t){for(var e=new Array(t),s=0;s<t;++s)e[s]=n[s];return e}function J(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function tt(n){for(var t=new Array(n.length),e=0;e<t.length;++e)t[e]=n[e].listener||n[e];return t}function et(n,t){return new Promise(function(e,s){function r(o){n.removeListener(t,i),s(o)}function i(){typeof n.removeListener=="function"&&n.removeListener("error",r),e([].slice.call(arguments))}G(n,t,i,{once:!0}),t!=="error"&&nt(n,r,{once:!0})})}function nt(n,t,e){typeof n.on=="function"&&G(n,"error",t,e)}function G(n,t,e,s){if(typeof n.on=="function")s.once?n.once(t,e):n.on(t,e);else if(typeof n.addEventListener=="function")n.addEventListener(t,function r(i){s.once&&n.removeEventListener(t,r),e(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var it=I.exports;class L extends it.EventEmitter{constructor(t={},e={}){super(),this.$stackIdx=-1,this.$event=null,this._stack=[],this._handlers={},this._handlers=Object.assign({},t),this.option=Object.assign({},e),this.rigister()}get _stackIdx(){return this.$stackIdx}set _stackIdx(t){const e=t-this.$stackIdx,s=this._stack[t],r=this._stack[this.$stackIdx],i=e>0;this.$event={target:i?s:r,end:i?r:s,step:e,redo:i},this.$stackIdx=t,this.emit(L.events.STACK_CHANGE,this.$event)}get undoDisabled(){return this._stackIdx<0}get redoDisabled(){return this._stackIdx>=this._stack.length-1}dispatch(t){this._stack.splice(this._stackIdx+1);const e=this._stack.push(t);this.$event=null,Number.isSafeInteger(this.option.maxLength)&&e>this.option.maxLength&&this._stack.shift(),this._stackIdx=Math.min(this._stack.length-1,this._stackIdx+1)}excute(t){this.emit(t.type,this.$event),this.$event=null}undo(){this.undoDisabled||this.excute(this._stack[this._stackIdx--])}redo(){this.redoDisabled||this.excute(this._stack[++this._stackIdx])}rigister(t){const e=this._handlers=t||this._handlers;let s;for(s in e)this.on(s,e[s])}clean(){this._stackIdx=-1,this._stack=[],this.$event=null}destroy(){this.clean();const t=this._handlers;let e;for(e in t)this.off(e,t[e]);this._handlers={}}}L.events={STACK_CHANGE:"stack.change"};var V={exports:{}},D={exports:{}};/*!
 * Infinite Scroll v2.0.4
 * measure size of elements
 * MIT license
 */var R;function st(){return R||(R=1,function(n){(function(t,e){n.exports?n.exports=e():t.getSize=e()})(window,function(){function e(o){let h=parseFloat(o);return o.indexOf("%")==-1&&!isNaN(h)&&h}let s=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];function r(){let o={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};return s.forEach(h=>{o[h]=0}),o}function i(o){if(typeof o=="string"&&(o=document.querySelector(o)),!(o&&typeof o=="object"&&o.nodeType))return;let l=getComputedStyle(o);if(l.display=="none")return r();let d={};d.width=o.offsetWidth,d.height=o.offsetHeight;let a=d.isBorderBox=l.boxSizing=="border-box";s.forEach(b=>{let E=l[b],x=parseFloat(E);d[b]=isNaN(x)?0:x});let c=d.paddingLeft+d.paddingRight,p=d.paddingTop+d.paddingBottom,_=d.marginLeft+d.marginRight,u=d.marginTop+d.marginBottom,f=d.borderLeftWidth+d.borderRightWidth,v=d.borderTopWidth+d.borderBottomWidth,m=e(l.width);m!==!1&&(d.width=m+(a?0:c+f));let y=e(l.height);return y!==!1&&(d.height=y+(a?0:p+v)),d.innerWidth=d.width-(c+f),d.innerHeight=d.height-(p+v),d.outerWidth=d.width+_,d.outerHeight=d.height+u,d}return i})}(D)),D.exports}var C={exports:{}},O={exports:{}},H;function ot(){return H||(H=1,function(n){(function(t,e){n.exports?n.exports=e():t.EvEmitter=e()})(typeof window<"u"?window:T,function(){function t(){}let e=t.prototype;return e.on=function(s,r){if(!s||!r)return this;let i=this._events=this._events||{},o=i[s]=i[s]||[];return o.includes(r)||o.push(r),this},e.once=function(s,r){if(!s||!r)return this;this.on(s,r);let i=this._onceEvents=this._onceEvents||{},o=i[s]=i[s]||{};return o[r]=!0,this},e.off=function(s,r){let i=this._events&&this._events[s];if(!i||!i.length)return this;let o=i.indexOf(r);return o!=-1&&i.splice(o,1),this},e.emitEvent=function(s,r){let i=this._events&&this._events[s];if(!i||!i.length)return this;i=i.slice(0),r=r||[];let o=this._onceEvents&&this._onceEvents[s];for(let h of i)o&&o[h]&&(this.off(s,h),delete o[h]),h.apply(this,r);return this},e.allOff=function(){return delete this._events,delete this._onceEvents,this},t})}(O)),O.exports}/*!
 * Unidragger v3.0.1
 * Draggable base class
 * MIT license
 */var j;function rt(){return j||(j=1,function(n){(function(t,e){n.exports?n.exports=e(t,ot()):t.Unidragger=e(t,t.EvEmitter)})(typeof window<"u"?window:T,function(e,s){function r(){}let i=r.prototype=Object.create(s.prototype);i.handleEvent=function(a){let c="on"+a.type;this[c]&&this[c](a)};let o,h;"ontouchstart"in e?(o="touchstart",h=["touchmove","touchend","touchcancel"]):e.PointerEvent?(o="pointerdown",h=["pointermove","pointerup","pointercancel"]):(o="mousedown",h=["mousemove","mouseup"]),i.touchActionValue="none",i.bindHandles=function(){this._bindHandles("addEventListener",this.touchActionValue)},i.unbindHandles=function(){this._bindHandles("removeEventListener","")},i._bindHandles=function(a,c){this.handles.forEach(p=>{p[a](o,this),p[a]("click",this),e.PointerEvent&&(p.style.touchAction=c)})},i.bindActivePointerEvents=function(){h.forEach(a=>{e.addEventListener(a,this)})},i.unbindActivePointerEvents=function(){h.forEach(a=>{e.removeEventListener(a,this)})},i.withPointer=function(a,c){c.pointerId===this.pointerIdentifier&&this[a](c,c)},i.withTouch=function(a,c){let p;for(let _ of c.changedTouches)_.identifier===this.pointerIdentifier&&(p=_);p&&this[a](c,p)},i.onmousedown=function(a){this.pointerDown(a,a)},i.ontouchstart=function(a){this.pointerDown(a,a.changedTouches[0])},i.onpointerdown=function(a){this.pointerDown(a,a)};const l=["TEXTAREA","INPUT","SELECT","OPTION"],d=["radio","checkbox","button","submit","image","file"];return i.pointerDown=function(a,c){let p=l.includes(a.target.nodeName),_=d.includes(a.target.type),u=!p||_;!this.isPointerDown&&!a.button&&u&&(this.isPointerDown=!0,this.pointerIdentifier=c.pointerId!==void 0?c.pointerId:c.identifier,this.pointerDownPointer={pageX:c.pageX,pageY:c.pageY},this.bindActivePointerEvents(),this.emitEvent("pointerDown",[a,c]))},i.onmousemove=function(a){this.pointerMove(a,a)},i.onpointermove=function(a){this.withPointer("pointerMove",a)},i.ontouchmove=function(a){this.withTouch("pointerMove",a)},i.pointerMove=function(a,c){let p={x:c.pageX-this.pointerDownPointer.pageX,y:c.pageY-this.pointerDownPointer.pageY};this.emitEvent("pointerMove",[a,c,p]),!this.isDragging&&this.hasDragStarted(p)&&this.dragStart(a,c),this.isDragging&&this.dragMove(a,c,p)},i.hasDragStarted=function(a){return Math.abs(a.x)>3||Math.abs(a.y)>3},i.dragStart=function(a,c){this.isDragging=!0,this.isPreventingClicks=!0,this.emitEvent("dragStart",[a,c])},i.dragMove=function(a,c,p){this.emitEvent("dragMove",[a,c,p])},i.onmouseup=function(a){this.pointerUp(a,a)},i.onpointerup=function(a){this.withPointer("pointerUp",a)},i.ontouchend=function(a){this.withTouch("pointerUp",a)},i.pointerUp=function(a,c){this.pointerDone(),this.emitEvent("pointerUp",[a,c]),this.isDragging?this.dragEnd(a,c):this.staticClick(a,c)},i.dragEnd=function(a,c){this.isDragging=!1,setTimeout(()=>delete this.isPreventingClicks),this.emitEvent("dragEnd",[a,c])},i.pointerDone=function(){this.isPointerDown=!1,delete this.pointerIdentifier,this.unbindActivePointerEvents(),this.emitEvent("pointerDone")},i.onpointercancel=function(a){this.withPointer("pointerCancel",a)},i.ontouchcancel=function(a){this.withTouch("pointerCancel",a)},i.pointerCancel=function(a,c){this.pointerDone(),this.emitEvent("pointerCancel",[a,c])},i.onclick=function(a){this.isPreventingClicks&&a.preventDefault()},i.staticClick=function(a,c){let p=a.type==="mouseup";p&&this.isIgnoringMouseUp||(this.emitEvent("staticClick",[a,c]),p&&(this.isIgnoringMouseUp=!0,setTimeout(()=>{delete this.isIgnoringMouseUp},400)))},r})}(C)),C.exports}/*!
 * Draggabilly v3.0.0
 * Make that shiz draggable
 * https://draggabilly.desandro.com
 * MIT license
 */(function(n){(function(t,e){n.exports?n.exports=e(t,st(),rt()):t.Draggabilly=e(t,t.getSize,t.Unidragger)})(typeof window<"u"?window:T,function(e,s,r){function i(){}let o=e.jQuery;function h(u,f){this.element=typeof u=="string"?document.querySelector(u):u,o&&(this.$element=o(this.element)),this.options={},this.option(f),this._create()}let l=h.prototype=Object.create(r.prototype);l.option=function(u){this.options={...this.options,...u}};const d=["relative","absolute","fixed"];l._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition={...this.position};let u=getComputedStyle(this.element);d.includes(u.position)||(this.element.style.position="relative"),this.on("pointerDown",this.handlePointerDown),this.on("pointerUp",this.handlePointerUp),this.on("dragStart",this.handleDragStart),this.on("dragMove",this.handleDragMove),this.on("dragEnd",this.handleDragEnd),this.setHandles(),this.enable()},l.setHandles=function(){let{handle:u}=this.options;typeof u=="string"?this.handles=this.element.querySelectorAll(u):typeof u=="object"&&u.length?this.handles=u:u instanceof HTMLElement?this.handles=[u]:this.handles=[this.element]};const a=["dragStart","dragMove","dragEnd"];let c=l.emitEvent;l.emitEvent=function(u,f){if(!this.isEnabled&&a.includes(u))return;c.call(this,u,f);let m=e.jQuery;if(!m||!this.$element)return;let y,b=f;f&&f[0]instanceof Event&&([y,...b]=f);let x=m.Event(y);x.type=u,this.$element.trigger(x,b)},l._getPosition=function(){let u=getComputedStyle(this.element),f=this._getPositionCoord(u.left,"width"),v=this._getPositionCoord(u.top,"height");this.position.x=isNaN(f)?0:f,this.position.y=isNaN(v)?0:v,this._addTransformPosition(u)},l._getPositionCoord=function(u,f){if(u.includes("%")){let v=s(this.element.parentNode);return v?parseFloat(u)/100*v[f]:0}return parseInt(u,10)},l._addTransformPosition=function(u){let f=u.transform;if(!f.startsWith("matrix"))return;let v=f.split(","),m=f.startsWith("matrix3d")?12:4,y=parseInt(v[m],10),b=parseInt(v[m+1],10);this.position.x+=y,this.position.y+=b},l.handlePointerDown=function(u,f){this.isEnabled&&(this.pointerDownPointer={pageX:f.pageX,pageY:f.pageY},u.preventDefault(),document.activeElement.blur(),this.bindActivePointerEvents(u),this.element.classList.add("is-pointer-down"))},l.handleDragStart=function(){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.animate())},l.measureContainment=function(){let u=this.getContainer();if(!u)return;let f=s(this.element),v=s(u),{borderLeftWidth:m,borderRightWidth:y,borderTopWidth:b,borderBottomWidth:E}=v,x=this.element.getBoundingClientRect(),k=u.getBoundingClientRect(),X=m+y,K=b+E,M=this.relativeStartPosition={x:x.left-(k.left+m),y:x.top-(k.top+b)};this.containSize={width:v.width-X-M.x-f.width,height:v.height-K-M.y-f.height}},l.getContainer=function(){let u=this.options.containment;return u?u instanceof HTMLElement?u:typeof u=="string"?document.querySelector(u):this.element.parentNode:void 0},l.handleDragMove=function(u,f,v){if(!this.isEnabled)return;let m=v.x,y=v.y,b=this.options.grid,E=b&&b[0],x=b&&b[1];m=p(m,E),y=p(y,x),m=this.containDrag("x",m,E),y=this.containDrag("y",y,x),m=this.options.axis=="y"?0:m,y=this.options.axis=="x"?0:y,this.position.x=this.startPosition.x+m,this.position.y=this.startPosition.y+y,this.dragPoint.x=m,this.dragPoint.y=y};function p(u,f,v){return f?(v=v||"round",Math[v](u/f)*f):u}l.containDrag=function(u,f,v){if(!this.options.containment)return f;let m=u=="x"?"width":"height",y=this.relativeStartPosition[u],b=p(-y,v,"ceil"),E=this.containSize[m];return E=p(E,v,"floor"),Math.max(b,Math.min(E,f))},l.handlePointerUp=function(){this.element.classList.remove("is-pointer-down")},l.handleDragEnd=function(){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"))},l.animate=function(){this.isDragging&&(this.positionDrag(),requestAnimationFrame(()=>this.animate()))},l.setLeftTop=function(){let{x:u,y:f}=this.position;this.element.style.left=`${u}px`,this.element.style.top=`${f}px`},l.positionDrag=function(){let{x:u,y:f}=this.dragPoint;this.element.style.transform=`translate3d(${u}px, ${f}px, 0)`},l.setPosition=function(u,f){this.position.x=u,this.position.y=f,this.setLeftTop()},l.enable=function(){this.isEnabled||(this.isEnabled=!0,this.bindHandles())},l.disable=function(){this.isEnabled&&(this.isEnabled=!1,this.isDragging&&this.dragEnd(),this.unbindHandles())};const _=["transform","left","top","position"];return l.destroy=function(){this.disable(),_.forEach(u=>{this.element.style[u]=""}),this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},l._init=i,o&&o.bridget&&o.bridget("draggabilly",h),h})})(V);var at=V.exports;const ut=Y(at);window.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector("#box"),t=document.querySelector('button[data-type="undo-drag"]'),e=document.querySelector('button[data-type="redo-drag"]'),s=new ut(n,{containment:"#container"});let r=[],i=[];const o=()=>{t.disabled=h.undoDisabled,e.disabled=h.redoDisabled},h=new L({MOVE({redo:c,target:{context:{points:p}}}){i=c?p.slice():p.slice().reverse(),t.disabled=!0,e.disabled=!0,s.disable(),a()}});window.dragcs=h,s.on("dragStart",()=>{r=[{...s.position}]}),s.on("dragMove",()=>{r.push({...s.position})}),s.on("dragEnd",()=>{h.dispatch({type:"MOVE",context:{points:r}}),r=[]});let l;function d(){const c=i.shift();return c==null?!1:(Object.assign(n.style,{left:`${c.x}px`,top:`${c.y}px`}),i.length)}function a(){if(!d())return s.enable(),o(),cancelAnimationFrame(l);d(),l=requestAnimationFrame(a)}h.on(L.events.STACK_CHANGE,o),t.onclick=h.undo.bind(h),e.onclick=h.redo.bind(h)});window.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector("#inp"),t=document.querySelector("#updateInp"),e=document.querySelector('button[data-type="undo"]'),s=document.querySelector('button[data-type="redo"]'),r=document.querySelector('button[data-type="insert"]'),i=document.querySelector('button[data-type="update"]'),o=new L({INSERT({redo:h,target:l,end:d}){if(h){n.value=l.context.value,console.log("INSERT redo:",n.value,l,d);return}n.value=l.context.oldValue,console.log("INSERT undo:",n.value,l,d)},CHANGE({redo:h,target:l,end:d}){if(h){n.value=l.context.value,console.log("CHANGE redo:",n.value,l,d);return}n.value=l.context.oldValue,console.log("CHANGE undo:",n.value,l,d)}},{maxLength:5});window.cs=o,o.on(L.events.STACK_CHANGE,()=>{e.disabled=o.undoDisabled,s.disabled=o.redoDisabled}),i.onclick=h=>{const l=t.value,d=n.value;n.value=l,o.dispatch({type:"CHANGE",context:{selectionStart:n.selectionStart,value:n.value,oldValue:d}})},r.onclick=()=>{if(!t.value)return;const h=`{${t.value}}`,l=n.value,d=n.selectionStart??l.length;n.value=l.slice(0,d)+h+l.slice(d),o.dispatch({type:"INSERT",context:{selectionStart:n.selectionStart,value:n.value,oldValue:l,insert:h}})},e.onclick=o.undo.bind(o),s.onclick=o.redo.bind(o)});
